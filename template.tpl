___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "ReklamStore Affiliate Conversion Pixel",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/jpeg;base64,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"
  },
  "description": "Use the ReklamStore DSP Affiliate Conversion Pixel template to easily track your campaigns",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "advSub",
    "displayName": "Advertiser Sub",
    "simpleValueType": true,
    "notSetText": "This value may be empty.",
    "valueHint": "Advertiser Sub"
  },
  {
    "type": "TEXT",
    "name": "transactionId",
    "displayName": "Transaction ID",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "valueHint": "Transaction ID"
  },
  {
    "type": "TEXT",
    "name": "amount",
    "displayName": "Amount",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "valueHint": "Amount"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const log = require('logToConsole');
const getQueryParameters = require('getQueryParameters');
const sendPixel = require('sendPixel');
const encodeUriComponent = require('encodeUriComponent');
const query = require('queryPermission');
const advSub = data.advSub;
const transactionId = data.transactionId;
const amount = data.amount;
const onSuccess = () => {
  log('Conductrics: Request loaded successfully.');
  data.gtmOnSuccess();
};

const onFailure = () => {
  log('Conductrics: Request load failed.');
  data.gtmOnFailure();
};

if(advSub != null){
	const url = ("https://ad.reklm.com/SPA7m?adv_sub="+advSub+"&amount="+amount+"&transaction_id="+transactionId);
  
  if (encodeUriComponent('sendPixel', url)) {
  	log('sendPixel: ', url);
	sendPixel(url, onSuccess, onFailure);
  	onSuccess();
  }
  
}
else{
  const url = ("https://ad.reklm.com/SPA7m?amount="+amount+"&transaction_id="+transactionId);
  
  if (encodeUriComponent('sendPixel', url)) {
  	log('sendPixel: ', url);
	sendPixel(url, onSuccess, onFailure);
  	onSuccess();
  }
}
        
log(advSub,transactionId,amount);

return data;


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "send_pixel",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://ad.reklm.com/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 23.01.2020 15:18:13


